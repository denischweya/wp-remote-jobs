jQuery(document).ready((function(o){console.log("Job List Script Loaded"),console.log("remjobsAjax available:","undefined"!=typeof remjobsAjax);let e=!1;"undefined"==typeof remjobsAjax?(console.warn("remjobsAjax not found, creating fallback..."),window.remjobsAjax={ajaxurl:"/wp-admin/admin-ajax.php",nonce:""},"undefined"!=typeof ajaxurl?window.remjobsAjax.ajaxurl=ajaxurl:"undefined"!=typeof wpApiSettings&&wpApiSettings.root&&(window.remjobsAjax.ajaxurl=wpApiSettings.root+"wp/v2/"),o.ajax({url:window.remjobsAjax.ajaxurl,type:"POST",data:{action:"get_filter_nonce"},success:function(o){o.success&&o.data.nonce?(window.remjobsAjax.nonce=o.data.nonce,window.remjobsAjax.ajaxurl=o.data.ajaxurl,e=!0,console.log("Successfully retrieved nonce from server:",window.remjobsAjax)):(console.warn("Failed to get nonce from server:",o),e=!0)},error:function(o,t,n){console.warn("Error getting nonce from server:",t,n),e=!0}}),console.log("Created fallback remjobsAjax:",window.remjobsAjax)):e=!0,"undefined"!=typeof remjobsAjax?console.log("remjobsAjax:",remjobsAjax):(console.error("remjobsAjax is still not available after fallback!"),console.log("Available global variables:",Object.keys(window)));const t=o("#jobs-list"),n=o("#job-search"),l=o("#job-category"),s=o("#job-location"),a=o("#job-skills"),r=o("#clear-filters");function c(){if(console.log("=== updateJobs function called ==="),!e)return console.log("AJAX system not ready yet, waiting..."),void setTimeout((function(){c()}),500);if("undefined"==typeof remjobsAjax)return void console.error("remjobsAjax is not available in updateJobs function");console.log("remjobsAjax in updateJobs:",remjobsAjax);const r=n.val()||"",i=l.val()||"",u=s.val()||"",d=a.val()||"";console.log("Filter values:"),console.log("- Search:",r),console.log("- Category:",i),console.log("- Location:",u),console.log("- Skills:",d);let g="grid";const j=o(".layout-toggle button.active");if(j.length){const o=j.data("layout");o&&(g=o)}console.log("Current layout detected from button:",g),t.html('<div class="loading">Loading jobs...</div>');const b={action:"filter_jobs",nonce:remjobsAjax.nonce,search:r,category:i,location:u,skills:d,layout:g};console.log("AJAX data being sent:",b),console.log("AJAX URL:",remjobsAjax.ajaxurl),b.nonce&&""!==b.nonce||console.warn("No nonce available, but proceeding (debug mode should handle this)"),o.ajax({url:remjobsAjax.ajaxurl,type:"POST",data:b,beforeSend:function(){console.log("AJAX request starting...")},success:function(o){console.log("AJAX Success response:",o),o.success?(console.log("Response data:",o.data),t.html(o.data.data),console.log("Jobs updated successfully. Found:",o.data.found,"posts")):(console.error("AJAX returned success=false:",o),t.html('<div class="error">Error loading jobs: '+(o.data.message||"Unknown error")+"</div>"))},error:function(e,n,l){console.error("AJAX Error:"),console.error("- Status:",n),console.error("- Error:",l),console.error("- Response:",e.responseText),console.error("- Status Code:",e.status),400!==e.status||remjobsAjax.nonce||(console.log("Trying to get a fresh nonce..."),o.ajax({url:remjobsAjax.ajaxurl,type:"POST",data:{action:"get_filter_nonce"},success:function(o){if(o.success&&o.data.nonce)return remjobsAjax.nonce=o.data.nonce,console.log("Got fresh nonce, retrying filter request..."),void setTimeout(c,100)}})),t.html('<div class="error">Error loading jobs. Please try again.</div>')},complete:function(){console.log("AJAX request completed")}})}o(".job-search-form"),console.log("DOM Elements Found:"),console.log("- Job List Container (#jobs-list):",t.length),console.log("- Search Input (#job-search):",n.length),console.log("- Category Select (#job-category):",l.length),console.log("- Location Select (#job-location):",s.length),console.log("- Skills Select (#job-skills):",a.length),console.log("- Clear Filters Link (#clear-filters):",r.length),r.length&&r.on("click",(function(o){o.preventDefault(),console.log("Clear Filters button clicked"),n.val("").trigger("change"),l.val("").trigger("change"),s.val("").trigger("change"),a.val("").trigger("change"),c()})),n.on("keyup",function(o){let e;return function(...t){clearTimeout(e),e=setTimeout((()=>{clearTimeout(e),o(...t)}),500)}}(c)),l.on("change",(function(){console.log("Category changed to:",o(this).val()),c()})),s.on("change",(function(){console.log("Location changed to:",o(this).val()),c()})),a.on("change",(function(){console.log("Skills changed to:",o(this).val()),c()}));const i=o(".layout-toggle button");i.length?(console.log("Layout toggle buttons found:",i.length),i.on("click",(function(){const e=o(this).data("layout");console.log("Layout button clicked:",e);const n=t.find('[class*="job-listings-"]');n.length?(n.removeClass("job-listings-grid job-listings-list"),n.addClass("job-listings-"+e),console.log("Applied layout class: job-listings-"+e)):console.warn("Job listings container not found"),i.removeClass("is-primary active").addClass("is-secondary"),o(this).removeClass("is-secondary").addClass("is-primary active"),console.log("Layout switched to:",e),c()}))):console.log("No layout toggle buttons found"),document.querySelectorAll(".save-job-button").forEach((o=>{o.addEventListener("click",(e=>{e.preventDefault();const t=o.dataset.jobId;t&&(o.classList.toggle("saved"),console.log("Toggle saved state for job ID:",t))}))}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".job-card.premium, .job-row.premium").forEach((o=>{const e=document.createElement("div");e.className="premium-indicator",e.innerHTML='\n\t\t\t<svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">\n\t\t\t\t<path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"></path>\n\t\t\t</svg>\n\t\t',o.appendChild(e)}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".save-job-button").forEach((o=>{o.addEventListener("click",(function(e){e.preventDefault();const t=o.querySelector("svg");"none"===t.getAttribute("fill")?(t.setAttribute("fill","currentColor"),o.setAttribute("title","Saved")):(t.setAttribute("fill","none"),o.setAttribute("title","Save job"))}))}))}));